
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required Meta Tags Always Come First -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Title -->
    <title>Pesanan - PPK</title>

    <!-- Favicon -->
    <script type="text/javascript" nonce="70e7f7e5717a4d9c952a2c98ba0" src="//local.adguard.org?ts=1763540279326&amp;type=content-script&amp;dmn=bela.gratisongkir.id&amp;url=https%3A%2F%2Fbela.gratisongkir.id%2Fppk%2Forders%2Freceived&amp;app=chrome.exe&amp;css=3&amp;js=1&amp;rel=1&amp;rji=1&amp;sbe=1"></script><script type="text/javascript" nonce="70e7f7e5717a4d9c952a2c98ba0" src="//local.adguard.org?ts=1763540279326&amp;name=AdGuard%20Extra&amp;name=AdGuard%20Popup%20Blocker&amp;type=user-script"></script><link rel="shortcut icon" href="https://bela.gratisongkir.id/favicon.png ">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <!-- toastify -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

    <!-- CSS Implementing Plugins -->
    <link rel="stylesheet" href="https://bela.gratisongkir.id/dist/assets/vendor/icon-set/style.css">
    <link rel="stylesheet" href="https://bela.gratisongkir.id/assets/css/jquery-confirm.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="/dist/assets/vendor/select2/dist/css/select2.min.css">

    <!-- CSS Front Template -->
    <link rel="stylesheet" href="https://bela.gratisongkir.id/dist/assets/css/theme.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">

    <style>
        .navbar-brand-logo {
            min-width: 150px !important;
        }

        .nav-link:hover {
            color: #d82525 !important;
        }

        .nav-link.active {
            color: #d82525 !important;
        }

        .nav-tabs .nav-item.show .nav-link,
        .nav-tabs .nav-link.active {
            border-color: #d82525 !important;
        }

        .navbar .active>.nav-link, .navbar .nav-link.active, .navbar .nav-link.show, .navbar .show>.nav-link{
            color: #d82525 !important;
        }

        .text-danger {
            color: #d82525 !important;
        }

        .success {
            background: linear-gradient(to right, #12da8d, #4cc971) !important;
        }

        .fail {
            background: linear-gradient(to right, #d42459, #dd3156) !important;
        }

        .navbar-vertical-fixed .navbar-vertical-footer-offset{
            padding-bottom: 0 !important;
        }

        .nav-icon-fas {
            width: 1rem;
            font-size: .8025rem;
            line-height: 1.4;
            opacity: .8;
            text-align: center;
            margin-right: .7rem;
        }

        .no-rotate {
            transform: rotate(0deg);
        }

        .spin-animation {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .form-switch {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-left: 1rem;
        }

        .form-switch .form-check-input {
            width: 36px;
            height: 18px;
            appearance: none;
            background: #ccc;
            border-radius: 18px;
            transition: background 0.2s ease-in-out;
            cursor: pointer;
            position: relative;
        }

        .form-switch .form-check-input::before {
            content: "";
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform 0.2s ease-in-out;
        }

        .form-switch .form-check-input:checked {
            background: #0d6efd;
        }

        .form-switch .form-check-input:checked::before {
            transform: translateX(18px);
        }

        .form-switch label {
            font-size: 14px;
            margin-top:3px;
            cursor: pointer;
        }
    </style>

                        <script src="https://asset.inaproc.id/online-store/script/v1/bridge.runtime.js"
                data-site-id="gratis-ongkir"
                data-bridge-environment="production">
            </script>
            
</head>

<body class="has-navbar-vertical-aside navbar-vertical-aside-show-xl footer-offset">

    <script src="https://bela.gratisongkir.id/dist/assets/vendor/hs-navbar-vertical-aside/hs-navbar-vertical-aside-mini-cache.js">
    </script>

    <!-- ========== HEADER ========== -->

    <header id="header"
        class="navbar navbar-expand-lg navbar-fixed navbar-height navbar-flush navbar-container navbar-bordered">
        <div class="navbar-nav-wrap">
            <div class="navbar-brand-wrapper">
                <!-- Logo -->
                <a class="navbar-brand" href="https://bela.gratisongkir.id/ppk/orders/all" aria-label="Front">
                    <img class="navbar-brand-logo" src="https://bela.gratisongkir.id/assets/img/logo2.png" alt="Logo">
                </a>
                <!-- End Logo -->
            </div>

            <div class="navbar-nav-wrap-content-left">
                <!-- Navbar Vertical Toggle -->
                <button type="button" class="js-navbar-vertical-aside-toggle-invoker close mr-3">
                    <i class="tio-first-page navbar-vertical-aside-toggle-short-align" data-toggle="tooltip"
                        data-placement="right" title="Collapse"></i>
                    <i class="tio-last-page navbar-vertical-aside-toggle-full-align"
                        data-template='<div class="tooltip d-none d-sm-block" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>'
                        data-toggle="tooltip" data-placement="right" title="Expand"></i>
                </button>
                <!-- End Navbar Vertical Toggle -->
            </div>

            <!-- Secondary Content -->
            <div class="navbar-nav-wrap-content-right">
                <!-- Navbar -->
                <ul class="navbar-nav align-items-center flex-row">
                    <li class="nav-item d-flex align-items-center">
                        <!-- Pusat Bantuan -->
                        <div class="hs-unfold">
                                                    </div>

                        <!-- Account -->
                        <div class="hs-unfold ml-3">
                            <a class="js-hs-unfold-invoker navbar-dropdown-account-wrapper ml-1" href="javascript:;"
                                data-hs-unfold-options='{
                                    "target": "#accountNavbarDropdown",
                                    "type": "css-animation"
                                }'>
                                <div class="avatar avatar-sm avatar-circle" style="width: 40px; height: 40px;">
                                    <img class="avatar-img" src="https://bela.gratisongkir.id/dist/assets/img/160x160/img1.jpg"
                                        alt="Image Description" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </a>

                            <div id="accountNavbarDropdown"
                                class="hs-unfold-content dropdown-unfold dropdown-menu dropdown-menu-right navbar-dropdown-menu navbar-dropdown-account"
                                style="width: 16rem;">
                                <div class="dropdown-item-text">
                                    <div class="media align-items-center">
                                        <div class="avatar avatar-sm avatar-circle mr-2" style="width: 40px; height: 40px;">
                                            <img class="avatar-img"
                                                src="https://bela.gratisongkir.id/dist/assets/img/160x160/img1.jpg"
                                                alt="Image Description" style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                        <div class="media-body">
                                            <span class="card-title h5">Adi Prayitno, Spd., Mm</span>
                                            <span class="card-text">0</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="dropdown-divider"></div>

                                <a class="dropdown-item" href="https://bela.gratisongkir.id/logout/ppk">
                                    <span class="text-truncate pr-2 text-danger" title="Sign out">Keluar</span>
                                </a>
                            </div>
                        </div>
                        <!-- End Account -->
                    </li>
                </ul>
                <!-- End Navbar -->
            </div>
            <!-- End Secondary Content -->
        </div>
    </header>





    <!-- ========== END HEADER ========== -->

    <!-- ========== MAIN CONTENT ========== -->
    <!-- Navbar Vertical -->

    <aside
        class="js-navbar-vertical-aside navbar navbar-vertical-aside navbar-vertical navbar-vertical-fixed navbar-expand-xl navbar-bordered  ">
        <div class="navbar-vertical-container">
            <div class="navbar-vertical-footer-offset">
                <div class="navbar-brand-wrapper justify-content-between">
                    <!-- Logo -->

                    <a class="navbar-brand" href="https://bela.gratisongkir.id/ppk/orders/new" aria-label="Front">
                        <img class="navbar-brand-logo" src="https://bela.gratisongkir.id/assets/img/logo2.png" alt="Logo">
                        <img class="navbar-brand-logo-mini" src="https://bela.gratisongkir.id/assets/img/logo3.png" alt="Logo">
                    </a>

                    <!-- End Logo -->

                    <!-- Navbar Vertical Toggle -->
                    <button type="button"
                        class="js-navbar-vertical-aside-toggle-invoker navbar-vertical-aside-toggle btn btn-icon btn-xs btn-ghost-dark">
                        <i class="tio-clear tio-lg"></i>
                    </button>
                    <!-- End Navbar Vertical Toggle -->
                </div>

                <!-- Content -->
                <div class="navbar-vertical-content">
                    <ul class="navbar-nav navbar-nav-lg nav-tabs">
                        

                        <li class="navbar-vertical-aside-has-menu ">
                            <a class="js-nav-tooltip-link nav-link active text-danger"
                                href="https://bela.gratisongkir.id/ppk/orders/new" title="Pesanan"
                                data-placement="left">
                                <i class="tio-shopping-icon nav-icon"></i>
                                <span
                                    class="navbar-vertical-aside-mini-mode-hidden-elements text-truncate">Pesanan</span>
                            </a>
                        </li>

                        
                        <li class="navbar-vertical-aside-has-menu ">
                            <a class="js-nav-tooltip-link nav-link "
                                href="https://bela.gratisongkir.id/ppk/complain/open" title="Komplain"
                                data-placement="left">
                                <i class="tio-sad nav-icon"></i>
                                <span
                                    class="navbar-vertical-aside-mini-mode-hidden-elements text-truncate">Komplain</span>
                            </a>
                        </li>
                                                <li class="navbar-vertical-aside-has-menu ">
                            <a class="js-nav-tooltip-link nav-link "
                                href="https://bela.gratisongkir.id/ppk/review" title="review"
                                data-placement="left">
                                <i class="tio-chat-outlined nav-icon"></i>
                                <span
                                    class="navbar-vertical-aside-mini-mode-hidden-elements text-truncate">Ulasan</span>
                            </a>
                        </li>
                                                                        <li class="navbar-vertical-aside-has-menu ">
                            <a class="js-nav-tooltip-link nav-link "
                                href="https://bela.gratisongkir.id/ppk/profile" title="profile"
                                data-placement="left">
                                <i class="tio-user-outlined nav-icon"></i>
                                <span
                                    class="navbar-vertical-aside-mini-mode-hidden-elements text-truncate">Pengaturan Akun</span>
                            </a>
                        </li>
                    </ul>

                </div>
            </div>
        </div>
    </aside>

    <main id="content" role="main" class="main">
        <!-- Content -->
<div class="content container-fluid">
    <!-- Page Header -->
    <div class="page-header">

        
        <div class="row align-items-center p-1">
            <div class="col">
                <h1 class="page-header-title">Pesanan</h1>
            </div>
            
        </div>
        <!-- End Row -->

        <div class="collapse mb-3" id="collapse">
            <div class="text-center py-5">
                <div class="spinner-border spinner-primary" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </div>

        <!-- Nav Scroller -->
        <div class="js-nav-scroller hs-nav-scroller-horizontal">
            <span class="hs-nav-scroller-arrow-prev" style="display: none;">
                <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                    <i class="tio-chevron-left"></i>
                </a>
            </span>

            <span class="hs-nav-scroller-arrow-next" style="display: none;">
                <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                    <i class="tio-chevron-right"></i>
                </a>
            </span>

            <!-- Nav -->
            <ul class="nav nav-tabs page-header-tabs menu">
                <li class="nav-item">
    <a class="nav-link " data-status="all"
        href="javascript:;">Semua Pesanan
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="need approval"
        href="javascript:;">Butuh Persetujuan
        <span class="badge badge-danger">0</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="new"
        href="javascript:;">Pesanan Baru
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="prepare"
        href="javascript:;">Disiapkan
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="shipping"
        href="javascript:;">Dalam Pengiriman
        <span class="badge badge-danger">0</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="complain"
        href="javascript:;">Dikomplain
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link active" data-status="received"
        href="javascript:;">Diterima
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="invoiced"
        href="javascript:;">Dalam Penagihan
        <span class="badge badge-danger">0</span>
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="paid"
        href="javascript:;">Terbayar
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="completed"
        href="javascript:;">Selesai
        (0)
    </a>
</li>
<li class="nav-item">
    <a class="nav-link " data-status="canceled"
        href="javascript:;">Dibatalkan
        (0)
    </a>
</li>
            </ul>

            <!-- End Nav -->
        </div>
        <!-- End Nav Scroller -->
    </div>
    <!-- End Page Header -->

    
    
        <div class="border rounded-lg py-2 px-3 d-sm-flex align-items-sm-center mb-2" id="filterContainer">
            <form class="form-inline w-100" method="GET" id="filterForm">
                <h3 class="mb-0 text-muted"><i class="tio-filter-outlined mr-2 my-1"></i></h3>

                <div class="input-group my-1 mr-1">
                    <input type="date" name="start_date" class="form-control form-control-sm"
                        max="2025-11-19" value="">
                    <input type="date" name="end_date" class="form-control form-control-sm"
                        value="2025-11-19" max="2025-11-19" required>
                </div>

                <select id="paymentExpiredSelect" name="payment_expired_at" class="form-control form-control-sm my-1 mr-1 d-none">
                    <option value="" selected disabled>Tempo Pembayaran</option>
                    <option value="expired">Sudah Jatuh Tempo</option>
                    <option value="not_expired">Belum Jatuh Tempo</option>
                </select>

                <button type="submit" class="btn btn-sm btn-soft-primary font-weight-bold my-1 mr-1">Filter</button>
                <button type="button" id="clearFilter" style="display: none"
                    class="btn btn-sm btn-soft-danger font-weight-bold my-1">Hapus Filter</button>
            </form>
        </div>

    <!-- Card -->
    <div class="card">
        <!-- Header -->
        <div class="card-header">
            <div class="row justify-content-between align-items-center flex-grow-1">
                <div class="col-lg-4 mb-3 mb-lg-0">

                        <!-- Search -->
                        <div class="input-group input-group-merge input-group-flush">
                            <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <i class="tio-search"></i>
                                </div>
                            </div>
                            <input id="datatableSearch" type="search" class="form-control" placeholder="Cari Pesanan"  aria-label="Cari Pesanan">
                        </div>
                        <!-- End Search -->

                </div>

                <div class="col-lg-6">
                    <div class="d-sm-flex justify-content-sm-end align-items-sm-center">

                        <!-- Unfold -->
                        <div class="hs-unfold">
                            <a class="js-hs-unfold-invoker btn btn-sm btn-white" href="javascript:;"
                                data-hs-unfold-options='{
                                    "target": "#showHideDropdown",
                                    "type": "css-animation"
                                }'>
                                <i class="tio-table mr-1"></i> Columns <span
                                    class="badge badge-soft-dark rounded-circle ml-1">9</span>
                            </a>

                            <div id="showHideDropdown"
                                class="hs-unfold-content dropdown-unfold dropdown-menu dropdown-menu-right dropdown-card"
                                style="width: 15rem;">
                                <div class="card card-sm">
                                    <div class="card-body">

                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">SP</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_0">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="0" id="toggleColumn_0" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Tanggal Pesan</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_1">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="1" id="toggleColumn_1" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Jatuh Tempo Pembayaran</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_2">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="2" id="toggleColumn_2" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Status</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_3">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="3" id="toggleColumn_3" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Wapu</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_4">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="4" id="toggleColumn_4" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Pembeli</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_5">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="5" id="toggleColumn_5" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Penjual</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_6">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="6" id="toggleColumn_6" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="mr-2">Total</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_7">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="7" id="toggleColumn_7" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                                                                <div
                                            class="d-flex justify-content-between align-items-center ">
                                            <span class="mr-2">Update</span>

                                            <!-- Checkbox Switch -->
                                            <label class="toggle-switch toggle-switch-sm" for="toggleColumn_8">
                                                <input type="checkbox" class="toggle-switch-input"
                                                    data-column="8" id="toggleColumn_8" checked>
                                                <span class="toggle-switch-label">
                                                    <span class="toggle-switch-indicator"></span>
                                                </span>
                                            </label>
                                            <!-- End Checkbox Switch -->
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- End Unfold -->
                    </div>
                </div>
            </div>
            <!-- End Row -->
        </div>
        <!-- End Header -->

        <!-- Table -->
        <div class="table-responsive datatable-custom" style="min-height: 300px;">

            <div class="text-center rounded position-absolute top-0 bottom-0 right-0 left-0" style="display:none; background-color: rgba(80, 0, 0, .05) !important; z-index:1" id="spiner">
                <div class="spinner-border text-danger" style="margin-top: 12vw" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>

            <table id="datatable"
                class="table table-hover table-borderless table-thead-bordered table-nowrap table-align-middle card-table"
                style="width: 100%" data-hs-datatables-options='{
                    "order": [0],
                    "info": {
                        "totalQty": "#datatableWithPaginationInfoTotalQty"
                    },
                    "entries": "#datatableEntries",
                    "pageLength": 10,
                    "isResponsive": false,
                    "isShowPaging": false,
                    "pagination": "datatablePagination"
                }'>
            </table>
        </div>
        <!-- End Table -->

        <!-- Footer -->
        <div class="card-footer">
            <!-- Pagination -->
            <div class="row justify-content-center justify-content-sm-between align-items-sm-center">
                <div class="col-sm mb-2 mb-sm-0">
                    <div class="d-flex justify-content-center justify-content-sm-start align-items-center">
                        <span class="mr-2">Showing:</span>

                        <!-- Select -->
                        <select id="datatableEntries" class="js-select2-custom" data-hs-select2-options='{
                            "minimumResultsForSearch": "Infinity",
                            "customClass": "custom-select custom-select-borderless",
                            "dropdownAutoWidth": true,
                            "width": true
                        }'>
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                        </select>
                        <!-- End Select -->

                        <span class="text-secondary mr-2">of</span>

                        <!-- Pagination Quantity -->
                        <span id="datatableWithPaginationInfoTotalQty"></span>
                    </div>
                </div>

                <div class="col-sm-auto">
                    <div class="d-flex justify-content-center justify-content-sm-end">
                        <!-- Pagination -->
                        <nav id="datatablePagination" aria-label="Activity pagination"></nav>
                    </div>
                </div>
            </div>
            <!-- End Pagination -->
        </div>
        <!-- End Footer -->
    </div>
    <!-- End Card -->
</div>
<!-- End Content -->

<div class="modal fade" id="accModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Konfrimasi Penerimaan Barang</h4>
                <button type="button" class="btn btn-xs btn-icon btn-soft-secondary" data-dismiss="modal"
                    aria-label="Close">
                    <svg aria-hidden="true" width="10" height="10" viewBox="0 0 18 18"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor"
                            d="M11.5,9.5l5-5c0.2-0.2,0.2-0.6-0.1-0.9l-1-1c-0.3-0.3-0.7-0.3-0.9-0.1l-5,5l-5-5C4.3,2.3,3.9,2.4,3.6,2.6l-1,1 C2.4,3.9,2.3,4.3,2.5,4.5l5,5l-5,5c-0.2,0.2-0.2,0.6,0.1,0.9l1,1c0.3,0.3,0.7,0.3,0.9,0.1l5-5l5,5c0.2,0.2,0.6,0.2,0.9-0.1l1-1 c0.3-0.3,0.3-0.7,0.1-0.9L11.5,9.5z" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
            </div>
        </div>
    </div>
</div>

        <!-- Footer -->
        <div class="footer">
            <div class="row justify-content-between align-items-center mt-3">
                <div class="col">
                    <p class="font-size-sm mb-0"><span class="d-none d-sm-inline-block">Dashboard v4</span></p>
                </div>
                <div class="col-auto">
                    <div class="d-flex justify-content-end">
                        <!-- List Dot -->
                        <ul class="list-inline list-separator">
                            <li class="list-inline-item">
                                2025 &copy; <a class="list-separator-link" href="#">Gratis Ongkir</a>
                            </li>
                        </ul>
                        <!-- End List Dot -->
                    </div>
                </div>
            </div>
        </div>
        <!-- End Footer -->
    </main>
    <!-- ========== END MAIN CONTENT ========== -->


    <!-- JS Global Compulsory  -->
    <script src="https://bela.gratisongkir.id/dist/assets/vendor/jquery/dist/jquery.min.js"></script>
    <script src="https://bela.gratisongkir.id/dist/assets/vendor/jquery-migrate/dist/jquery-migrate.min.js"></script>
    <script src="https://bela.gratisongkir.id/dist/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://bela.gratisongkir.id/dist/assets/vendor/hs-navbar-vertical-aside/hs-navbar-vertical-aside.min.js"></script>
    <script src="https://bela.gratisongkir.id/dist/assets/vendor/hs-unfold/dist/hs-unfold.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- JS Front -->
    <script src="https://bela.gratisongkir.id/dist/assets/js/theme.min.js"></script>

    <!-- JS Plugins Init. -->
    <script src="https://bela.gratisongkir.id/assets/js/jquery-confirm.min.js"></script>
    <script>
        // $( document ).ajaxStart(function() {
        //     $('#spiner').show();
        // });

        // $(document).ajaxStop(function() {
        //     $('#spiner').hide();
        // });

        $(document).on('ready', function () {
            $(document).on('hidden.bs.modal', '.modal', function () {
                document.activeElement.blur();
            });

            // =======================================================

            // BUILDER TOGGLE INVOKER
            // =======================================================
            $('.js-navbar-vertical-aside-toggle-invoker').click(function () {
                $('.js-navbar-vertical-aside-toggle-invoker i').tooltip('hide');
            });

            // INITIALIZATION OF NAVBAR VERTICAL NAVIGATION
            // =======================================================
            var sidebar = $('.js-navbar-vertical-aside').hsSideNav();


            // INITIALIZATION OF TOOLTIP IN NAVBAR VERTICAL MENU
            // =======================================================
            $('.js-nav-tooltip-link').tooltip({ boundary: 'window' })

            $(".js-nav-tooltip-link").on("show.bs.tooltip", function(e) {
                if (!$("body").hasClass("navbar-vertical-aside-mini-mode")) {
                    return false;
                }
            });

            // INITIALIZATION OF UNFOLD
            // =======================================================
            $('.js-hs-unfold-invoker').each(function () {
                var unfold = new HSUnfold($(this)).init();
            });

        });

        jconfirm.defaults = {
            draggable: false,
            animateFromElement: false,
            content: 'Anda yakin ingin melanjutkan aksi?',
            bgOpacity: .3,
            animation: 'zoom',
            closeAnimation: 'scale',
            animationSpeed: 150,
            animationBounce: 1,
            backgroundDismiss: false,
            backgroundDismissAnimation: 'shake',
        };

        function number(x) {
            x = Math.round(x);
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        function convertTZ(date, tzString) {
            return new Date((typeof date === "string" ? new Date(date) : date).toLocaleString("en-US", {timeZone: tzString}));
        }
    </script>

    <script src="https://bela.gratisongkir.id/dist/assets/vendor/hs-nav-scroller/dist/hs-nav-scroller.min.js"></script>
<script src="https://bela.gratisongkir.id/dist/assets/vendor/datatables/media/js/jquery.dataTables.min.js"></script>
<script src="https://bela.gratisongkir.id/dist/assets/vendor/datatables.net-buttons/js/buttons.colVis.min.js"></script>
<script src="/dist/assets/vendor/select2/dist/js/select2.full.min.js"></script>

<script>
    $(document).on('ready', function () {

        // INITIALIZATION OF SELECT2
        // =======================================================
        $('.js-select2-custom').each(function () {
            var select2 = $.HSCore.components.HSSelect2.init($(this));
        });

        // INITIALIZATION OF NAV SCROLLER
        // =======================================================
        $('.js-nav-scroller').each(function () {
            new HsNavScroller($(this)).init()
        });

        function updateNav() {
            $.get(window.location.href+'?nav=true', function(data, status){
                $('.menu').html(data);
                $('.menu li a').on('click', function(e) {
                    event.preventDefault();
                    $('.menu li a').removeClass('active');
                    $(this).addClass('active');
                    url = "https://bela.gratisongkir.id/ppk/orders/"+e.target.dataset.status;
                    if (['all', 'invoiced'].includes(e.target.dataset.status)) {
                        $('#paymentExpiredSelect').removeClass('d-none');
                    } else {
                        $('#paymentExpiredSelect').addClass('d-none').val('');
                    }
                    window.history.pushState('Page', 'Title', url);
                    datatable.ajax.url(url).load();
                });
            });
        }

        $('#accModal').on('show.bs.modal', function (e) {
            let id = $(e.relatedTarget).data('id');
            $.ajax({
                type: "GET",
                url: "https://bela.gratisongkir.id/ppk/orders/acc/"+id,
                success: function (html) {
                    $('#accModal .modal-body').html(html);

                    $('#accForm').on('submit', function(e){
                        e.preventDefault()
                        updateOrder(id, 'received')
                    })
                }
            });
        });

        let consolidationRelease = false;

        let columns = [
            {
                title:'Surat Pesanan', data:'id', render: function(data, meta, row){
                    return `<a href="detail/${data}">#${row.generated_id}</a>`;
                }
            },
            {title:'Tanggal Pesan', data:'created_at', searchable: false},
            {
                title:'Jatuh Tempo Pembayaran', data:'expired_at', searchable: false, render: function(data, type, row) {
                    const expiredAt = new Date(data);
                    const now = new Date();
                    const isOverdue = expiredAt < now && row.status === 'invoiced';

                    if (isOverdue) {
                        return `
                            <span
                                style="color: red; font-weight: bold;"
                                data-toggle="tooltip"
                                data-placement="top"
                                title="tagihan belum terbayar lebih dari 30 hari"
                                data-original-title="tagihan belum terbayar lebih dari 30 hari"
                            >
                                ${data} <i class="fas fa-exclamation-triangle" style="margin-left: 4px;"></i>
                            </span>
                        `;
                    } else if (['paid', 'completed'].includes(row.status)) {
                        return `
                            <span
                                style="color: #00c9a7; font-weight: bold;"
                                data-toggle="tooltip"
                                data-placement="top"
                                title="tagihan sudah terbayar"
                                data-original-title="tagihan sudah terbayar"
                            >
                                ${data} <i class="fas fa-check" style="margin-left: 4px;"></i>
                            </span>
                        `;
                    }
                    else {
                        return `<span style="color: #677788;">${data}</span>`;
                    }
                }
            },
            {
                title:'Status', data:'status', render: function(data, meta, row){
                    return `
                    <span class="badge badge-soft-${row.translated_status.color} text-capitalize">
                        <span class="legend-indicator bg-${row.translated_status.color}"></span> ${row.translated_status.text}
                    </span>
                    `;
                }
            },
            {
                title:'Wapu', data:'pmk', render: function(data, meta, row){

                    if(data == 58){
                        wapu = 'Marketplace'
                    }else{
                        wapu = 'Bendahara'
                    }

                    return `
                    <span class="badge badge-soft-danger">
                        ${wapu}
                    </span>
                    `;
                }
            },
            {title:'Pembeli',  data:'ppk.instansi', orderable: false},
            {title:'Penjual', data:'seller.name', orderable: false},
            {title:'Total', data:'cash_in', searchable: false, render: function(data, meta, row){
                return 'Rp'+number(data);
            }},
            {title:'Update',  data:'updated_at', searchable: false},
            {
                title:'', data:'id', orderable: false, className: 'text-right', render: function(data, meta, row){

                    let action = '';

                    if(row.status == 'need approval'){
                        action = `<a class="dropdown-item update" data-title="Setujui Pesanan?" href="javascript:;" data-id="${data}" data-status="new">
                                <i class="tio-checkmark-circle-outlined text-success dropdown-item-icon"></i> Setujui
                            </a>
                            <a class="dropdown-item canceled" href="javascript:;" data-id="${data}" data-status="canceled">
                                <i class="tio-clear-circle-outlined text-danger dropdown-item-icon"></i> Batalkan
                            </a>`;
                    }

                    else if(row.status == 'new'){
                        if(row.can_canceled){
                            action = `<a class="dropdown-item canceled" href="javascript:;" data-id="${data}" data-status="canceled">
                                <i class="tio-clear-circle-outlined text-danger dropdown-item-icon"></i> Batalkan
                            </a>`;
                        }
                    }

                    else if(row.status == 'shipping'){
                            action = `<a class="dropdown-item" data-id="${data}"  data-toggle="modal" href="#accModal">
                                <i class="tio-document-text-outlined text-primary dropdown-item-icon"></i> Terima Barang
                            </a>`;
                    }

                    const bast = ["received", "invoiced", "paid", "completed"]
                    const invoiced = ["invoiced", "paid", "completed"]

                    if(bast.includes(row.status)){
                        if(!row.ttd.hasOwnProperty('bast')){
                            action += `<a class="dropdown-item ttd-bast" data-title="Tanda tangan digital" href="javascript:;" data-id="${data} data-type="bast">
                                    <i class="tio-qr-code text-danger dropdown-item-icon"></i> TTD BAP
                                </a>`;
                        }
                    }

                    // if(invoiced.includes(row.status)){
                    //     if(!row.ttd.hasOwnProperty('invoice')){
                    //         action += `<a class="dropdown-item ttd-invoice" data-title="Tanda tangan Invoice" href="javascript:;"
                    //         data-id="${data}" data-type="invoice">
                    //                 <i class="tio-qr-code text-primary dropdown-item-icon"></i> TTD Invoice
                    //             </a>`;
                    //     }
                    // }

                    if(action == ''){
                        action = `<span class="dropdown-item text-muted"> Tidak ada aksi </span>`;
                    }

                    return `<div class="btn-group" role="group">
                                <a class="btn btn-sm btn-white" href="detail/${data}">
                                    <i class="tio-visible-outlined"></i> Detail
                                </a>
                                <button class="btn btn-icon btn-sm btn-white dropdown-toggle dropdown-toggle-empty" type="button" id="dropdownMenuButton" data-toggle="dropdown"></button>
                                <div class="dropdown-menu dropdown-menu-right mt-1" aria-labelledby="dropdownMenuButton">
                                    ${action}
                                </div>
                            </div>`;
                }
            },
        ];

        if (consolidationRelease) {
            columns.splice(7, 0, {
                data: "consolidation_id",
                title: "Konsolidasi",
                searchable: true,
                orderable: true,
                render: function (data, type, row) {
                    return row.is_consolidation
                        ? `<span class="text-danger" style="font-size: 12px;">
                                <a href="https://bela.gratisongkir.id/ppk/consolidations/detail/${row.consolidation_id}/order">#${row.consolidation_id}</a>
                        </span>`
                        : "-";
                }
            });
        }


        // INITIALIZATION OF DATATABLES
        // =======================================================
        var datatable = $.HSCore.components.HSDatatables.init($('#datatable'), {
            processing: true,
            serverSide: true,
            stateSave: true,
            stateSaveParams: function (settings, data) {
                data.search.search = "";
                data.length = 10;
            },
            ajax: window.location.href,
            language: {
                zeroRecords: `
                    <div class="text-center p-4">
                        <img class="mb-3" src="/dist/assets/svg/illustrations/sorry.svg" alt="Image Description" style="width: 7rem;">
                        <p class="mb-0">Tidak ada data</p>
                    </div>`,
                processing: `
                    <div class="position-absolute right-0 pt-1 pr-2">
                        <div class="spinner-border spinner-border-sm text-primary" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>`
            },
            columns: columns,
            "initComplete": function() {
                updateNav();
            },
            "drawCallback": function(){
                updateNav();

                $('[data-toggle="tooltip"]').tooltip();

                $('.update').confirm({
                    type: 'green',
                    buttons: {
                        Tutup(){},
                        confirm: {
                            text: 'Konfrimasi',
                            btnClass: 'btn-green',
                            action: function(){
                                updateOrder(this.$target.attr('data-id'), this.$target.attr('data-status'))
                            }
                        },
                    }
                })

                $('.ttd-bast').confirm({
                    type: 'blue',
                    buttons: {
                        Tutup(){},
                        confirm: {
                            text: 'Tanda Tangan',
                            btnClass: 'btn-blue',
                            action: function(){
                                ttd(this.$target.attr('data-id'), 'bast')
                            }
                        },
                    }
                })

                $('.ttd-invoice').confirm({
                    type: 'blue',
                    buttons: {
                        Tutup(){},
                        confirm: {
                            text: 'Tanda Tangan',
                            btnClass: 'btn-blue',
                            action: function(){
                                ttd(this.$target.attr('data-id'), 'invoice')
                            }
                        },
                    }
                })

                $('.canceled').confirm({
                    title: 'Batalkan Pesanan?',
                    content: '' +
                    '<form>' +
                    '<div class="form-group mb-1">' +
                    '<textarea type="text" placeholder="Alasan pembatalan pesanan" name="note" class="note form-control"></textarea>' +
                    '</div>' +
                    '</form>',
                    type: 'red',
                    buttons: {
                        Tutup(){},
                        formSubmit: {
                            text: 'Konfirmasi',
                            btnClass: 'btn-red',
                            action: function () {
                                let note = this.$content.find('.note').val();
                                if(!note){
                                    $.alert('Harap isi alasan pembatalan');
                                    return false;
                                }else{
                                    updateOrder(this.$target.attr('data-id'), this.$target.attr('data-status'), note)
                                }
                            }
                        },
                    }
                });

            }
        });

        //clear search
        $('#datatableSearch').on('mouseup', function (e) {
            var $input = $(this), oldValue = $input.val();
            if (oldValue == "") return;
            setTimeout(function(){
                var newValue = $input.val();
                if (newValue == ""){
                datatable.search('').draw();
                }
            }, 1);
        });

        //new search
        $('#datatableSearch').on('keyup', function (e) {
            input = $('#datatableSearch').val()
            if (e.key === "Enter"){
                datatable.search(input).draw();
            }
            if (input === ''){
                datatable.search(input).draw();
            }
        });

        $('.toggle-switch-input').change(function (e) {
            datatable.columns(e.target.dataset.column).visible(e.target.checked)
        })

        $('.toggle-switch-input').each(function (index){
            $(this).prop('checked', datatable.columns().visible()[index]);
        });

        $('#filterForm').on('submit', function (e) {
            e.preventDefault();
            if ($(this).serialize()) {
                $('#clearFilter').show();
                datatable.ajax.url(window.location.href + '?' + $(this).serialize()).load();
            }
        })

        $('#clearFilter').on('click', function () {
            $('#filterForm').trigger('reset');
            datatable.ajax.url(window.location.href).load();
            $('#clearFilter').hide();
        })

        $('.menu li a').on('click', function(e) {
            event.preventDefault();
            $('.menu li a').removeClass('active');
            $(this).addClass('active');
            url = "https://bela.gratisongkir.id/ppk/orders/"+e.target.dataset.status;
            window.history.pushState('Page', 'Title', url);
            datatable.ajax.url(url).load();
        });

        $('#collapse').on('shown.bs.collapse', function () {
            $.get(window.location.href+'?detail=true', function(html){
                $('[data-toggle="tooltip"]').tooltip();
                $('#collapse').html(html)
            });
        })

        function updateOrder(id, status, addition){
            $('#spiner').show();
            $.post("https://bela.gratisongkir.id/ppk/orders/update/"+id, {
                id: id,
                status: status,
                addition : addition,
                _token: "5E8y4osZJ9djTDClbnFpZyyWN5VZAv1trake5rcU" },
            function(data) {
                datatable.draw('false');
                updateNav()
                Toastify({
                    text: data.msg,
                    className: "success"
                }).showToast();
                $('#spiner').hide();
            }).fail(function(xhr, status, error) {
                Toastify({
                    text: xhr.responseJSON.msg ?? 'Terjadi masalah silahkan coba lagi',
                    className: "fail"
                }).showToast();
                $('#spiner').hide();
            }).done(function(){
                $('#accModal').modal('hide');
            })
            ;
        }

        function ttd(id, type){
            $('#spiner').show();
            $.post(`https://bela.gratisongkir.id/ppk/order/ttd/${id}/${type}`, {
                _token: "5E8y4osZJ9djTDClbnFpZyyWN5VZAv1trake5rcU" },
            function(data) {
                datatable.draw('false');
                Toastify({
                    text: data.msg,
                    className: "success"
                }).showToast();
                $('#spiner').hide();
            }).fail(function(xhr, status, error) {
                Toastify({
                    text: xhr.responseJSON.msg ?? 'Terjadi masalah silahkan coba lagi',
                    className: "fail"
                }).showToast();
                $('#spiner').hide();
            });
        }

    });
</script>

</body>

</html>
